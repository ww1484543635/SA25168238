% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rw_mh_theta_cpp.R
\name{rw_mh_theta_cpp}
\alias{rw_mh_theta_cpp}
\title{HMC sampler for theta (Rcpp)}
\usage{
rw_mh_theta_cpp(
  k,
  m = 10000L,
  w = 0.02,
  x0 = 0.5,
  L = 10L,
  burn = 0L,
  thin = 1L
)
}
\arguments{
\item{k}{Integer vector of length 4, the observed counts \code{(k1,k2,k3,k4)}.}

\item{m}{Integer, total number of iterations (including burn-in).}

\item{w}{Numeric, HMC step size (epsilon). Smaller values are more stable but slower.}

\item{x0}{Numeric, initial value of theta in (0,1).}

\item{L}{Integer, number of leapfrog steps per iteration.}

\item{burn}{Integer, number of burn-in iterations removed from the start.}

\item{thin}{Integer, keep every \code{thin}-th draw after burn-in.}
}
\value{
A list with:
\itemize{
  \item \code{chain}: numeric vector of posterior draws after burn-in and thinning.
  \item \code{accept_rate}: acceptance rate of HMC proposals.
}
}
\description{
This function generates samples of \eqn{\theta \in (0,1)} for the genetic linkage
example (Exercise 11.8). The posterior is proportional to a multinomial likelihood
with probabilities
\eqn{(1/2 + \theta/4,\ (1-\theta)/4,\ (1-\theta)/4,\ \theta/4)}.
}
\details{
Compared with a simple random-walk MH, HMC uses gradient information to propose
larger moves with a high acceptance rate. Internally we use a logit transform
\eqn{z=\log(\theta/(1-\theta))} so the algorithm runs on the real line.
}
\examples{
k <- c(125, 18, 20, 34)
out <- rw_mh_theta_cpp(k, m = 2000, w = 0.03, L = 15, burn = 200, thin = 2)
mean(out$chain)
out$accept_rate

}
